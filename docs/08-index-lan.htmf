<!-- <h2 class="new-file new-page display-none" id="sec:req:lan">4.3 LAN – Local Area Networking<a class="headerlink" href="08-index-lan.html#sec:req:lan" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h2> -->

<h3 id="sec:req:lan.gen">4.3.1 LAN.GEN – General LAN Protocols<a class="headerlink" href="08-index-lan.html#sec:req:lan.gen" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.gen.1">LAN.GEN.1<a class="headerlink" href="08-index-lan.html#req:lan.gen.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY support SOCKS as defined in RFC 1928 <span class="cite" data-citation-ids="RFC1928"><a href='03-index-references-and-terminology.html#ref-RFC1928' title=''>[56]</a></span> for non-ALG access
to the public address.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.gen.2">LAN.GEN.2<a class="headerlink" href="08-index-lan.html#req:lan.gen.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Both NetBios and zero config naming mechanisms MAY be used to populate
the DNS tables.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.gen.3">LAN.GEN.3<a class="headerlink" href="08-index-lan.html#req:lan.gen.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY act as a NETBIOS master browser for that name service.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.gen.4">LAN.GEN.4<a class="headerlink" href="08-index-lan.html#req:lan.gen.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support multiple subnets being used on the local LAN.</td>
</tr>
</table>

<h3 id="sec:req:lan.address">4.3.2 LAN.ADDRESS – Private IPv4 Addressing<a class="headerlink" href="08-index-lan.html#sec:req:lan.address" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.address.1">LAN.ADDRESS.1<a class="headerlink" href="08-index-lan.html#req:lan.address.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to be configured to specify alternate public and
private subnets (without restriction) for local device addressing.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.address.2">LAN.ADDRESS.2<a class="headerlink" href="08-index-lan.html#req:lan.address.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to be configured to specify the start and stop
addresses within a subnet used for local addressing.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.address.3">LAN.ADDRESS.3<a class="headerlink" href="08-index-lan.html#req:lan.address.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST NOT use auto IP for address assignment of its LAN-side IPv4
address.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.address.4">LAN.ADDRESS.4<a class="headerlink" href="08-index-lan.html#req:lan.address.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST allow its assigned address and netmask to be specified
through the Web GUI, Broadband Forum TR-064i2 <span class="cite" data-citation-ids="TR-064i2"><a href='03-index-references-and-terminology.html#ref-TR-064i2' title=''>[158]</a></span> interfaces and from a Controller.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.address.5">LAN.ADDRESS.5<a class="headerlink" href="08-index-lan.html#req:lan.address.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is in bridged configuration and LAN-side configuration is
enabled, the RG MUST ARP on the LAN side for the following addresses, in
order, and assign itself the first one that is not taken: 192.168.1.254,
192.168.1.63, and then starting from 192.168.1.253 and descending.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.address.6">LAN.ADDRESS.6<a class="headerlink" href="08-index-lan.html#req:lan.address.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST be able to assign its own WAN IPv4 address (i.e. its public
address) to a particular LAN device, concurrent with private IPv4
addressing being used for other LAN CPE.</p>

<p>In this situation, one device on the LAN is given the same public IPv4
address (through DHCP or manual configuration of the LAN CPE IPv4
stack). Other LAN devices utilize private IPv4 addresses. The RG can
then be configured as identified in <a href='08-index-lan.html#req:lan.pfwd.2' title=''>LAN.PFWD.2</a> so that the LAN device
sharing the WAN IPv4 address receives all unidentified or unsolicited
port traffic to any specific LAN device. If the RG is not configured in
this manner, then only inbound traffic resulting from outbound traffic
from the LAN CPE would be directed to that LAN CPE.</p>

<p>The gateway identified to the LAN device must be on the same subnet as
that associated with the WAN IPv4 address. Note that the use of the WAN
gateway address does not guarantee this since it need not meet this
requirement.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.address.7">LAN.ADDRESS.7<a class="headerlink" href="08-index-lan.html#req:lan.address.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When operating in multiple WAN public IPv4 address mode, the RG MUST
support up to 16 public IPv4 addresses being used by LAN devices
(statically or dynamically issued) and whose traffic must be routed to
and from the public IPv4 address associated with the LAN device.
Additionally, a transparent basic NAT mapping feature MAY be supported,
allowing the 16 public addresses to be mapped to a device’s private
address. A user configurable option in the Web GUI MUST be provided to
enable or disable the firewall on a per public IPv4 address basis. This
feature must operate concurrently with other LAN usage (e.g. NAPT on the
gateway’s primary IPv4 address).</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.address.8">LAN.ADDRESS.8<a class="headerlink" href="08-index-lan.html#req:lan.address.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>When using a WAN IPv4 address assigned to a LAN device, the RG MUST be
able to be configured by the user whether this LAN device can directly
communicate with other devices on the local LAN without the need to
traverse the broadband connection.</p>

<p>This will only be done to the extent to which the RG can control
isolation (e.g. routing and internal switch fabric). It does not extend
to isolation external to the RG (e.g. external switch or router), which
are beyond the control of the RG.</p></td>
</tr>
</table>

<h3 id="sec:req:lan.addressv6">4.3.3 LAN.ADDRESSv6 – LAN.ADDRESSv6- LAN IPv6 Addressing<a class="headerlink" href="08-index-lan.html#sec:req:lan.addressv6" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.addressv6.1">LAN.ADDRESSv6.1<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST create a Link Local (LL) address for its LAN interface, and
perform Duplicate Address Discovery (DAD), per RFC 4862 <span class="cite" data-citation-ids="RFC4862"><a href='03-index-references-and-terminology.html#ref-RFC4862' title=''>[115]</a></span>. It MUST always
use the same LL address, even after reboot or power failure.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.addressv6.2">LAN.ADDRESSv6.2<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD try alternate LL addresses, if DAD fails. The RG vendor
can define the algorithm to be used in this case.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.addressv6.3">LAN.ADDRESSv6.3<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST have a ULA prefix (RFC 4193 <span class="cite" data-citation-ids="RFC4193"><a href='03-index-references-and-terminology.html#ref-RFC4193' title=''>[101]</a></span>). It MUST always maintain the
same prefix, even after reboot or power failure, unless this prefix is
changed through configuration, in which case it MUST maintain the
changed value.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.addressv6.4">LAN.ADDRESSv6.4<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY allow its ULA prefix to be changed through configuration.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.addressv6.5">LAN.ADDRESSv6.5<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the ability to enable or disable advertising a /64
from its ULA prefix through Router Advertisement. When enabled, this /64
will be included in RA messages, with L=1, A=1, and reasonable timer
values.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.addressv6.6">LAN.ADDRESSv6.6<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support RFC 4861 <span class="cite" data-citation-ids="RFC4861"><a href='03-index-references-and-terminology.html#ref-RFC4861' title=''>[114]</a></span> section 6.2, Router specification
requirements.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.addressv6.7">LAN.ADDRESSv6.7<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support configuration of the following elements of a Router
Advertisement: M and O flags (RFC 4861 <span class="cite" data-citation-ids="RFC4861"><a href='03-index-references-and-terminology.html#ref-RFC4861' title=''>[114]</a></span>), route information (<span class="cite" data-citation-ids="RFC4191"><a href='03-index-references-and-terminology.html#ref-RFC4191' title=''>[100]</a></span>),
and default router preference (Prf) (<span class="cite" data-citation-ids="RFC4191"><a href='03-index-references-and-terminology.html#ref-RFC4191' title=''>[100]</a></span>).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.addressv6.8">LAN.ADDRESSv6.8<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support configuration of the following elements of a
router advertisement: MTU (RFC 4861 <span class="cite" data-citation-ids="RFC4861"><a href='03-index-references-and-terminology.html#ref-RFC4861' title=''>[114]</a></span>).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.addressv6.9">LAN.ADDRESSv6.9<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST advertise (in RA) a /64 prefix from all prefixes delegated
via the WAN interface. This will have L=1, A=1, and lifetimes per the
received (from the WAN) delegation.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.addressv6.10">LAN.ADDRESSv6.10<a class="headerlink" href="08-index-lan.html#req:lan.addressv6.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD advertise DNS server using the RDNSS option in Router
Advertisements (RFC 6106 <span class="cite" data-citation-ids="RFC6106"><a href='03-index-references-and-terminology.html#ref-RFC6106' title=''>[126]</a></span>).</td>
</tr>
</table>

<h3 id="sec:req:lan.dhcps">4.3.4 LAN.DHCPS – DHCPv4 Server<a class="headerlink" href="08-index-lan.html#sec:req:lan.dhcps" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.dhcps.1">LAN.DHCPS.1<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST provide application layer support for host name mapping,
booting, and management including DHCPv4 and the Domain Name System
(DNS) protocol. This includes support for the standards below:</p>

<ul>
<li><p>RFC 1034 <span class="cite" data-citation-ids="RFC1034"><a href='03-index-references-and-terminology.html#ref-RFC1034' title=''>[44]</a></span> Domain Names – Concepts and Facilities</p></li>
<li><p>RFC 1035 <span class="cite" data-citation-ids="RFC1035"><a href='03-index-references-and-terminology.html#ref-RFC1035' title=''>[45]</a></span> Domain Names – Implementation and Specification</p></li>
<li><p>RFC 2131 <span class="cite" data-citation-ids="RFC2131"><a href='03-index-references-and-terminology.html#ref-RFC2131' title=''>[60]</a></span> Dynamic Host Configuration Protocol</p></li>
<li><p>RFC 2132 <span class="cite" data-citation-ids="RFC2132"><a href='03-index-references-and-terminology.html#ref-RFC2132' title=''>[61]</a></span> DHCP Options and BOOTP Vendor Extensions</p></li>
<li><p>RFC 2181 <span class="cite" data-citation-ids="RFC2181"><a href='03-index-references-and-terminology.html#ref-RFC2181' title=''>[62]</a></span> Clarifications to the DNS Specification</p></li>
<li><p>RFC 2939 <span class="cite" data-citation-ids="RFC2939"><a href='03-index-references-and-terminology.html#ref-RFC2939' title=''>[75]</a></span> Procedures and IANA Guidelines for Definition of New
DHCP Options and Message Types</p></li>
</ul></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.2">LAN.DHCPS.2<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be a DHCPv4 server to local LAN devices, supporting all LAN
devices.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.3">LAN.DHCPS.3<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The embedded DHCPv4 server function of the RG MUST be able to operate
while in bridged mode. The default state should be on in bridged and
routed mode.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.4">LAN.DHCPS.4<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a minimum of 253 LAN devices.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.5">LAN.DHCPS.5<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support turning off the embedded DHCPv4 server via a
configuration change via the Web GUI, TR-064i2 interfaces and from a
Controller.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.dhcps.6">LAN.DHCPS.6<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MAY incorporate auto-detection of other DHCPv4 servers on the
local LAN and, if configured to do so, disable the internal DHCPv4
server functionality of the RG in this situation.</p>

<p>In this situation, the RG would try to obtain a configuration for its
LAN port through DHCPv4. If a DHCPv4 response was received, the RG would
then use the information in the DHCPv4 response (e.g. IPv4 address,
subnet and DNS information) and disable its internal DHCPv4 server. If
implemented and a DHCPv4 response is received, this requirement takes
precedence over requirement <a href='08-index-lan.html#req:lan.dhcps.15' title=''>LAN.DHCPS.15</a>.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.7">LAN.DHCPS.7<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The embedded DHCPv4 server functionality of the RG MUST verify that an
address is not in use prior to making it available in a lease (e.g. via
ping or ARP table validation) even when lease information shows that it
is not in use.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.8">LAN.DHCPS.8<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is in a routed configuration (i.e. full NAPT router), the RG
MUST use the default start address 192.168.1.64 and the default stop
address 192.168.1.253 for assignment to DHCPv4 leases for local device
addressing, or use an operator-specific configuration.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.9">LAN.DHCPS.9<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is in a routed configuration (i.e. full NAPT router), the RG
MUST use a default netmask of 255.255.255.0 for assignment to DHCPv4
leases for local device addressing, or use an operator-specific
configuration.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.dhcps.10">LAN.DHCPS.10<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>If the RG is in a bridged configuration for LAN device traffic
(i.e. NAT/NAPT is not enabled), the RG MUST support the enabling and
configuration of the local RG DHCPv4 server (address range and subnet
mask) remotely from a Controller. This address range may be either
public or private addresses (assuming that the service provider is
providing the NAT/NAPT function in the network).</p>

<p>Note that this assumes that a separate management IP (v4 or v6)
interface has been established to the RG expressly for the purpose of
CWMP or USP remote management.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.11">LAN.DHCPS.11<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The default lease time for DHCPv4 information provided to LAN CPE that
do not share the WAN side IPv4 address MUST be configurable. The default
value MUST be 24 hours, or use an operator-specific configuration.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.12">LAN.DHCPS.12<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The default lease time for DHCPv4 information provided to LAN CPE that
share the WAN side IPv4 address MUST be configurable. The default value
MUST be 10 minutes, or use an operator-specific configuration.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.13">LAN.DHCPS.13<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.13" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the domain name that the embedded DHCPv4 server passes to LAN CPE
has not been set, the value &ldquo;domain_not_set.invalid&rdquo; SHOULD be used.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.14">LAN.DHCPS.14<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.14" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is in a routed configuration (i.e. full NAPT router) and the
RG’s embedded DHCPv4 server is enabled, the RG itself MUST default to
the address 192.168.1.254 (with a netmask of 255.255.255.0), or use an
operator-specific configuration.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.15">LAN.DHCPS.15<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.15" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the RG’s embedded DHCPv4 server is disabled, the RG MUST ARP for
the following addresses, in order, and assign itself the first one that
is not taken: 192.168.1.254, 192.168.1.63, and then starting from
192.168.1.253 and descending.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.16">LAN.DHCPS.16<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.16" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY allow the embedded DHCPv4 server to be configured so that
specific MAC addresses can be identified as being served or not served.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcps.17">LAN.DHCPS.17<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.17" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY allow the embedded DHCPv4 server to be configured with a
default setting (provide IPv4 addresses or not provide IPv4 addresses)
for devices whose MAC addresses have not been specified in accordance
with <a href='08-index-lan.html#req:lan.dhcps.16' title=''>LAN.DHCPS.16</a>.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.dhcps.18">LAN.DHCPS.18<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.18" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The embedded DHCPv4 server functionality of the RG SHOULD provide a
mechanism by which an IPv4 address can be assigned to a particular LAN
device by MAC address. The user interface to establish this association
may use an alternate mechanism to identify this assignment (e.g. by
selecting the device using its current IPv4 address or device name) and
the MAC address may be transparent to the user. These addresses may
include addresses within the default subnet or addresses from additional
public/private subnets that may be provisioned.</p>

<p>For example, the RG might have a default WAN side IPv4 address that is
used for NAPT to a subset of devices and an additional set of WAN side
IPv4 addresses that are bridged. The embedded DHCPv4 server might be
used to assign this second set of IPv4 addresses to specific LAN CPE.</p></td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.dhcps.19">LAN.DHCPS.19<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.19" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support a single PC mode of operation. In this mode of
operation only a single LAN device is supported. Note that this is not
the default mode of operation.</p>

<p>In this configured mode, all network traffic, except for configured
management traffic destined for the RG itself (e.g. temporary remote
access to the Web GUI) MUST be passed between the access network and the
designated LAN device as if the RG was not present.</p>

<p>One possible implementation is for the embedded DHCPv4 server to issue
one and only one private address in this situation, with the start and
stop addresses for the embedded DHCPv4 server being the same.</p>

<p>The LAN devices can be assigned either a private IPv4 address
(i.e. using 1:1 NAT) or the public IPv4 address of the RG (i.e. using IP
pass-through as identified in requirement <a href='08-index-lan.html#req:lan.address.6' title=''>LAN.ADDRESS.6</a>). The type of
IPv4 address to be used (private or public) is configured through the
Web GUI, TR-064i2 interfaces and from a Controller. The default is a
public IPv4 address.</p>

<p>If a WAN connection is not available when the RG is configured to use a
public IPv4 address, the RG provides a private IPv4 address to the LAN
device via DHCPv4. Once a WAN connection is established, the public IPv4
address provided by the broadband network is passed to the LAN device
during the next DHCPv4 lease renewal.</p>

<p>The RG acts as the default gateway to the LAN devices when private IPv4
addressing is in use. When public IPv4 addressing is in use, the gateway
identified to the LAN device should be that identified in requirement
<a href='08-index-lan.html#req:lan.address.6' title=''>LAN.ADDRESS.6</a> above.</p>

<p>No other restrictions (e.g. restricted routing for other devices) need
to be implemented to meet this requirement (e.g. no routing restrictions
on traffic from secondary devices on the LAN).</p></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcps.20">LAN.DHCPS.20<a class="headerlink" href="08-index-lan.html#req:lan.dhcps.20" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is configured in a routed configuration (i.e. full NAPT
router), the RG MUST operate by default in the multiple PC mode of
operation, or use an operator-specific configuration.</td>
</tr>
</table>

<h3 id="sec:req:lan.dhcpv6s">4.3.5 LAN.DHCPv6S – DHCPv6 Server<a class="headerlink" href="08-index-lan.html#sec:req:lan.dhcpv6s" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.1">LAN.DHCPv6S.1<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support DHCPv6 server messages and behavior per RFC 3315 <span class="cite" data-citation-ids="RFC3315"><a href='03-index-references-and-terminology.html#ref-RFC3315' title=''>[84]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.2">LAN.DHCPv6S.2<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support and be configurable to enable/disable address
assignment using DHCPv6.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.3">LAN.DHCPv6S.3<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST either have an algorithm or allow configuration (or both) as
to which /64 prefix to use, from any received WAN prefixes or its own
ULA prefix.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.4">LAN.DHCPv6S.4<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD be configurable to support rules as to which host devices
will be assigned addresses through DHCPv6. That is, it should be
possible for a service provider to place its own host devices at the
customer premises and have the RG only support DHCPv6 address assignment
to those devices. Note that this does not require use of the RA &ldquo;M&rdquo;
flag, as the service provider host devices can be configured to always
use DHCPv6 for address assignment. The DUID may help to identify host
devices.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.5">LAN.DHCPv6S.5<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be configurable to enable/disable prefix delegation via
DHCPv6.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.6">LAN.DHCPv6S.6<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support delegation of any received WAN prefix and its own
ULA prefix, that is shorter than /64, using mechanisms of RFC 3633 <span class="cite" data-citation-ids="RFC3633"><a href='03-index-references-and-terminology.html#ref-RFC3633' title=''>[90]</a></span>.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.7">LAN.DHCPv6S.7<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The WAN / ULA prefixes that an RG is allowed to further delegate SHOULD
be configurable.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.8">LAN.DHCPv6S.8<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support DHCPv6 Information_request messages.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.9">LAN.DHCPv6S.9<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the following DHCPv6 options: IA_NA (<span class="cite" data-citation-ids="RFC3315"><a href='03-index-references-and-terminology.html#ref-RFC3315' title=''>[84]</a></span>),
IA_PD (<span class="cite" data-citation-ids="RFC3633"><a href='03-index-references-and-terminology.html#ref-RFC3633' title=''>[90]</a></span>), and DNS_SERVERS (<span class="cite" data-citation-ids="RFC3646"><a href='03-index-references-and-terminology.html#ref-RFC3646' title=''>[91]</a></span>).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.10">LAN.DHCPv6S.10<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support Reconfigure Accept (<span class="cite" data-citation-ids="RFC3315"><a href='03-index-references-and-terminology.html#ref-RFC3315' title=''>[84]</a></span>) and pass the
additional set of DHCP options received from the DHCP client on its WAN
interface to IPv6 hosts.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dhcpv6s.11">LAN.DHCPv6S.11<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The options that the RG will provide via DHCPv6 MUST be configurable.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dhcpv6s.12">LAN.DHCPv6S.12<a class="headerlink" href="08-index-lan.html#req:lan.dhcpv6s.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If address selection policy option is requested in a DHCPv6 request from
hosts, the RG SHOULD advertise the generated address selection policy
(see <a href='07-index-wan.html#req:wan.ipv6.21' title=''>WAN.IPv6.21</a>).</td>
</tr>
</table>

<h3 id="sec:req:lan.dns">4.3.6 LAN.DNS – Naming Services (IPv4 and general requirements)<a class="headerlink" href="08-index-lan.html#sec:req:lan.dns" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dns.1">LAN.DNS.1<a class="headerlink" href="08-index-lan.html#req:lan.dns.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be capable of acting as a DNS server to LAN devices, passing
its address as the DNS server back to these devices in DHCPv4 requests.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dns.2">LAN.DNS.2<a class="headerlink" href="08-index-lan.html#req:lan.dns.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD allow the user to specify that either network-learned or
user-specified addresses be passed back to LAN devices as the DNS
server(s) in DHCPv4 responses, instead of the RG’s address.</td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.dns.3">LAN.DNS.3<a class="headerlink" href="08-index-lan.html#req:lan.dns.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>When the RG learns DNS name server addresses from multiple WAN
connections, the RG MUST follow specified DNS selection policy (if one
is configured) to make recursive queries to DNS name servers, or (if
there is no DNS selection policy) MUST query a server on each connection
simultaneously and provide the requesting LAN client with the first
returned positive result from these DNS servers. A negative response
will not be transmitted to a LAN device until all WAN DNS servers have
either timed out or returned a negative response to a common query.</p>

<p>Service providers may choose not to provide DNS name server addresses on
certain connections in a multiple connection configuration.</p></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dns.4">LAN.DNS.4<a class="headerlink" href="08-index-lan.html#req:lan.dns.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST add the DNS entry &ldquo;dsldevice&rdquo; for its own address.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dns.5">LAN.DNS.5<a class="headerlink" href="08-index-lan.html#req:lan.dns.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY support additional DNS entries, as there could be additional
types of CPE.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dns.6">LAN.DNS.6<a class="headerlink" href="08-index-lan.html#req:lan.dns.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST maintain local DNS entries for a minimum of 253 local LAN
devices. This information can be obtained through auto discovery
(e.g. from DHCPv4 requests, such as Client Identifier, and other
protocol information). When unknown, the entry MUST be of the form
&ldquo;unknownxxxxxxxxxxxx&rdquo; where &ldquo;x&rdquo; represents the MAC address of the
associated LAN device.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dns.7">LAN.DNS.7<a class="headerlink" href="08-index-lan.html#req:lan.dns.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD provide a manual mechanism for overriding the learned
names of all LAN CPE except that of the RG itself.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dns.8">LAN.DNS.8<a class="headerlink" href="08-index-lan.html#req:lan.dns.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG’s DNS server is implemented as a forwarding proxy, it MUST be
done according to the recommendations in RFC 5625 <span class="cite" data-citation-ids="RFC5625"><a href='03-index-references-and-terminology.html#ref-RFC5625' title=''>[120]</a></span>.</td>
</tr>
</table>

<h3 id="sec:req:lan.dnsv6">4.3.7 LAN.DNSv6 – LAN.DNSv6- Naming Services (IPv6)<a class="headerlink" href="08-index-lan.html#sec:req:lan.dnsv6" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dnsv6.1">LAN.DNSv6.1<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST act as a DNS server for IPv6-capable LAN devices by
supporting IPv6 (AAAA) records in its DNS server (per <span class="cite" data-citation-ids="RFC3596"><a href='03-index-references-and-terminology.html#ref-RFC3596' title=''>[89]</a></span>) and
allowing these records to be queried using either IPv4 or IPv6 transport
(<span class="cite" data-citation-ids="RFC3901"><a href='03-index-references-and-terminology.html#ref-RFC3901' title=''>[93]</a></span>).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dnsv6.2">LAN.DNSv6.2<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST attach all known (for the host device) globally scoped IPv6
addresses to the DNS record for a particular host device (see
<a href='08-index-lan.html#req:lan.dns.6' title=''>LAN.DNS.6</a>), as AAAA records for that device.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dnsv6.3">LAN.DNSv6.3<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support dynamic DNS (DDNS) for devices to provide their
own DNS information. This would override any DNS entries the RG might
have created for the IP addresses included in the DDNS request.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dnsv6.4">LAN.DNSv6.4<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to query for A and AAAA records using either IPv4 or
IPv6 transport to DNS recursive name servers in the WAN.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dnsv6.5">LAN.DNSv6.5<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD use a DNS recursive name server obtained through DHCPv6
option 23 (OPTION_DNS_SERVERS) to query for AAAA records to the WAN, as
its first choice.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dnsv6.6">LAN.DNSv6.6<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the RG is proxying DNS queries for LAN devices, it SHOULD use IPv6
transport regardless of the transport mode used by the LAN device, when
querying to the WAN. This is only possible if the RG has IPv6 addresses
for DNS recursive name servers on the WAN.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dnsv6.7">LAN.DNSv6.7<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support receiving at least 2 DNS recursive name server IPv6
addresses from the network through DHCPv6 option 23 (OPTION_DNS_SERVERS)
(<span class="cite" data-citation-ids="RFC3646"><a href='03-index-references-and-terminology.html#ref-RFC3646' title=''>[91]</a></span>).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.dnsv6.8">LAN.DNSv6.8<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD allow the user to specify that the network-learned or
user-specified DNS recursive name server addresses be passed back to the
LAN devices in DHCPv6 responses instead of the RG’s address itself as
the DNS recursive name server(s).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.dnsv6.9">LAN.DNSv6.9<a class="headerlink" href="08-index-lan.html#req:lan.dnsv6.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the RG learns DNS name server addresses from multiple WAN
connections, the RG SHOULD make recursive query to the DNS name server
specified with DNS selection policy that is obtained through DHCPv6
(draft-ietf-mif-dns-server-selection) or manually configured DNS
selection policy.</td>
</tr>
</table>

<h3 id="sec:req:lan.nat">4.3.8 LAN.NAT – LAN.NAT- NAT/NAPT<a class="headerlink" href="08-index-lan.html#sec:req:lan.nat" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.nat.1">LAN.NAT.1<a class="headerlink" href="08-index-lan.html#req:lan.nat.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support Network Address Port Translation (NAPT; also known
as Port Address Translation) as defined in RFC 2663 <span class="cite" data-citation-ids="RFC2663"><a href='03-index-references-and-terminology.html#ref-RFC2663' title=''>[73]</a></span>, RFC 3022
<span class="cite" data-citation-ids="RFC3022"><a href='03-index-references-and-terminology.html#ref-RFC3022' title=''>[76]</a></span>, and RFC 3027 <span class="cite" data-citation-ids="RFC3027"><a href='03-index-references-and-terminology.html#ref-RFC3027' title=''>[77]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.nat.2">LAN.NAT.2<a class="headerlink" href="08-index-lan.html#req:lan.nat.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support disabling NAPT.</td>
</tr>
</table>

<h3 id="sec:req:lan.pfwd">4.3.9 LAN.PFWD – Port Forwarding (IPv4)<a class="headerlink" href="08-index-lan.html#sec:req:lan.pfwd" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.pfwd.1">LAN.PFWD.1<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support port forwarding. That is, the RG MUST be able to be
configured to direct traffic based on any combination of source IPv4
address, source protocol (TCP or UDP) and port (or port range) to a
particular LAN device and port (or port range on that device).</p>

<p>Individual port forwarding rules MUST be associated with a LAN device,
not the IPv4 address of the LAN device, and follow the LAN device should
its IPv4 address change.</p></td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.pfwd.2">LAN.PFWD.2<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The port forwarding mechanism MUST be able to be configured to direct
all inbound unidentified or unsolicited port traffic originating from a
user-selected public IPv4 address to any user selected LAN device.</p>

<p>The LAN device may be using either a private IPv4 address or the public
WAN IPv4 address as identified in requirement <a href='08-index-lan.html#req:lan.address.6' title=''>LAN.ADDRESS.6</a> and
<a href='08-index-lan.html#req:lan.address.7' title=''>LAN.ADDRESS.7</a>.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.pfwd.3">LAN.PFWD.3<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The port forwarding mechanism of the RG SHOULD be easy to configure for
common applications and user protocols (e.g. ftp, http, etc.) by
specifying a protocol name or application name in a &ldquo;Common Applications
Names List&rdquo; instead of a port number and protocol type. A partial list
of applications for potential inclusion appears in Appendix I.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.pfwd.4">LAN.PFWD.4<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The &ldquo;Common Applications Names List&rdquo; mechanism MUST be integrated with
the port forwarding mechanism.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.pfwd.5">LAN.PFWD.5<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST include port forwarding configurations and &ldquo;Common
Applications Name Listings&rdquo; for the following applications and protocols
that do not function properly with NAT or NAPT: FTP client, H.323, SIP,
IPsec, PPTP, MSN Messenger, AOL Instant Messenger, Yahoo Messenger and
ICQ.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.pfwd.6">LAN.PFWD.6<a class="headerlink" href="08-index-lan.html#req:lan.pfwd.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD include port forwarding configurations and &ldquo;Common
Applications Name Listings&rdquo; for other major applications and protocols
that do not function properly with NAT or NAPT.</td>
</tr>
</table>

<h3 id="sec:req:lan.pfwdv6">4.3.10 LAN.PFWDv6 – LAN.PFWDv6- Port Forwarding (IPv6)<a class="headerlink" href="08-index-lan.html#sec:req:lan.pfwdv6" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.pfwdv6.1">LAN.PFWDv6.1<a class="headerlink" href="08-index-lan.html#req:lan.pfwdv6.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support security mechanisms described in RFC 6092 <span class="cite" data-citation-ids="RFC6092"><a href='03-index-references-and-terminology.html#ref-RFC6092' title=''>[125]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.pfwdv6.2">LAN.PFWDv6.2<a class="headerlink" href="08-index-lan.html#req:lan.pfwdv6.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Individual port forwarding rules MUST be associated with a LAN device,
not the IPv6 address of the LAN device, and follow the LAN device should
its IPv6 address change.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.pfwdv6.3">LAN.PFWDv6.3<a class="headerlink" href="08-index-lan.html#req:lan.pfwdv6.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The port forwarding mechanism of the RG SHOULD be easy to configure for
common applications and user protocols (e.g. ftp, http, etc.) by
specifying a protocol name or application name in a &ldquo;Common Applications
Names List&rdquo; instead of a port number and protocol type. A partial list
of applications for potential inclusion appears in Appendix I.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.pfwdv6.4">LAN.PFWDv6.4<a class="headerlink" href="08-index-lan.html#req:lan.pfwdv6.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD NOT apply RFC 6092 <span class="cite" data-citation-ids="RFC6092"><a href='03-index-references-and-terminology.html#ref-RFC6092' title=''>[125]</a></span> security mechanisms to traffic
associated with prefixes it has delegated to other routers inside the
LAN.</td>
</tr>
</table>

<h3 id="sec:req:lan.alg">4.3.11 LAN.ALG – ALG Functions (IPv4)<a class="headerlink" href="08-index-lan.html#sec:req:lan.alg" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.alg.1">LAN.ALG.1<a class="headerlink" href="08-index-lan.html#req:lan.alg.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST allow for pass-through of IPv4 traffic in which the payload
is compressed or encrypted (e.g. VPN traffic).</p>

<p>This means that, as well as the RG, it must be possible that LAN CPE
originate PPTP and L2TP sessions to an external network (over IPv4).</p></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.alg.2">LAN.ALG.2<a class="headerlink" href="08-index-lan.html#req:lan.alg.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST allow LAN CPE to originate IPv4 IPsec sessions to an
external network. This function MUST work properly through the NAPT
function of the RG.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.alg.3">LAN.ALG.3<a class="headerlink" href="08-index-lan.html#req:lan.alg.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left"><em>This requirement is encompassed by .4</em></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.alg.4">LAN.ALG.4<a class="headerlink" href="08-index-lan.html#req:lan.alg.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST allow multiple devices on the LAN to launch independent and
simultaneous IPv4 IPsec sessions. These sessions can be to the same or
separate destinations.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.alg.5">LAN.ALG.5<a class="headerlink" href="08-index-lan.html#req:lan.alg.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support LAN device UDP encapsulation of IPv4 IPsec packets
as defined in RFC 3948 <span class="cite" data-citation-ids="RFC3948"><a href='03-index-references-and-terminology.html#ref-RFC3948' title=''>[97]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.alg.6">LAN.ALG.6<a class="headerlink" href="08-index-lan.html#req:lan.alg.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support LAN device negotiation of NAT traversal with IKE as
identified in RFC 3947 <span class="cite" data-citation-ids="RFC3947"><a href='03-index-references-and-terminology.html#ref-RFC3947' title=''>[96]</a></span>.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.alg.7">LAN.ALG.7<a class="headerlink" href="08-index-lan.html#req:lan.alg.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG should support a minimum of 4 concurrent LAN IPv4 IPsec sessions
per LAN device. These sessions can be to the same or separate
destinations.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.alg.8">LAN.ALG.8<a class="headerlink" href="08-index-lan.html#req:lan.alg.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST seamlessly handle RTSP traffic to LAN devices with no user
intervention required.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.alg.9">LAN.ALG.9<a class="headerlink" href="08-index-lan.html#req:lan.alg.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST allow the service provider to disable SIP ALG functionality.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.alg.10">LAN.ALG.10<a class="headerlink" href="08-index-lan.html#req:lan.alg.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be aware of the presence of active SIP clients on the LAN
side using some rules (e.g. matching IP address, port, or protocol
number through interception of SIP REGISTER messages).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.alg.11">LAN.ALG.11<a class="headerlink" href="08-index-lan.html#req:lan.alg.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The SIP ALG function MUST keep track of SIP events (e.g. REGISTER reply
from the registrar) and maintain allocated resources within the event
timeout period.</td>
</tr>
</table>

<h3 id="sec:req:lan.fwd">4.3.12 LAN.FWD – Connection Forwarding<a class="headerlink" href="08-index-lan.html#sec:req:lan.fwd" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>The IPv6 parts of this module apply only if the RG has an IPv6 stack.</p>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.1">LAN.FWD.1<a class="headerlink" href="08-index-lan.html#req:lan.fwd.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to route IP (v4 or v6) over Ethernet to LAN CPE.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.2">LAN.FWD.2<a class="headerlink" href="08-index-lan.html#req:lan.fwd.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">PPPoE forwarding and associated operation in the RG MUST NOT fail nor
operate improperly in the presence of vendor-specific PPPoE extensions
that may be in use by LAN devices (i.e. the RG MUST interoperate with
well known PPPoE client software).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.3">LAN.FWD.3<a class="headerlink" href="08-index-lan.html#req:lan.fwd.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a minimum of eight LAN device-initiated PPPoE
sessions from each LAN device being forwarded to a logical WAN
connection.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.4">LAN.FWD.4<a class="headerlink" href="08-index-lan.html#req:lan.fwd.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to forward up to eight PPPoE sessions per logical
WAN interface (PVC, RFC 2684 <span class="cite" data-citation-ids="RFC2684"><a href='03-index-references-and-terminology.html#ref-RFC2684' title=''>[74]</a></span> connection, VLAN, etc.).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.5">LAN.FWD.5<a class="headerlink" href="08-index-lan.html#req:lan.fwd.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to forward PPPoE sessions at all times when
encapsulating Ethernet over AAL5. This applies when the RG has set up
zero or more PPPoE sessions and/or when the RG is also running IP over
Ethernet. The default setting MUST be for this pass-through to be on.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.6">LAN.FWD.6<a class="headerlink" href="08-index-lan.html#req:lan.fwd.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support manually setting (via the Web GUI and TR-064i2
interfaces) an MTU to be used in negotiating MTU, overriding the default
MTU. This applies to MTU negotiated in IPv4 or IPv6.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.7">LAN.FWD.7<a class="headerlink" href="08-index-lan.html#req:lan.fwd.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support path MTU discovery as defined in IETF RFC 1191 <span class="cite" data-citation-ids="RFC1191"><a href='03-index-references-and-terminology.html#ref-RFC1191' title=''>[50]</a></span> so
that a LAN device can be told what to set its MTU to for IPv4 traffic.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.8">LAN.FWD.8<a class="headerlink" href="08-index-lan.html#req:lan.fwd.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support accepting IP (v4 and v6) forwarding/routing
information from a Controller.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.9">LAN.FWD.9<a class="headerlink" href="08-index-lan.html#req:lan.fwd.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST maintain route table entries for all connections it
maintains on the WAN (e.g. per PVC, IP (v4 and v6) and PPP sessions) and
for all LAN networks (including subnets).</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.fwd.10">LAN.FWD.10<a class="headerlink" href="08-index-lan.html#req:lan.fwd.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST allow for the selection of which traffic to forward over
which connection (in the case of multiple PVCs, multiple PPPoE sessions,
GPON Port ID, etc…) according to any one or more of the following
pieces of information:</p>

<ol>
<li><p>destination IP (v4 or v6) address(es) with subnet mask,</p></li>
<li><p>originating IP (v4 or v6) address(es) with subnet mask,</p></li>
<li><p>source MAC address,</p></li>
<li><p>destination MAC address,</p></li>
<li><p>protocol (TCP, UDP, ICMP, …)</p></li>
<li><p>source port,</p></li>
<li><p>destination port,</p></li>
<li><p>IEEE 802.1Q user priority,</p></li>
<li><p>FQDN (fully qualified domain name) of WAN session,</p></li>
<li><p>DiffServ codepoint (<span class="cite" data-citation-ids="RFC3260"><a href='03-index-references-and-terminology.html#ref-RFC3260' title=''>[82]</a></span>),</p></li>
<li><p>Ethertype (IEEE 802.3 length/type field), and</p></li>
<li><p>traffic handled by an ALG.</p></li>
</ol></td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.fwd.11">LAN.FWD.11<a class="headerlink" href="08-index-lan.html#req:lan.fwd.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST allow for the selection of which traffic to forward over
which connection (in the case of multiple PVCs, multiple PPPoE sessions,
etc.) according to any one or more of the following pieces of
information:</p>

<ol>
<li><p>IEEE 802.1Q VLAN identification, and</p></li>
<li><p>packet length (Note: to be used judiciously to avoid out of order
packet delivery).</p></li>
</ol></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.12">LAN.FWD.12<a class="headerlink" href="08-index-lan.html#req:lan.fwd.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST NOT bridge or route between WAN connections (i.e. WAN to
WAN) except when explicitly configured to do so.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.13">LAN.FWD.13<a class="headerlink" href="08-index-lan.html#req:lan.fwd.13" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST NOT forward UPnP traffic (including UPnP multicast messages)
to the WAN interface. This applies to both bridged and routed style
configurations. This satisfies TR-101 R-235.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.fwd.14">LAN.FWD.14<a class="headerlink" href="08-index-lan.html#req:lan.fwd.14" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD be able to restrict the routing information for each WAN
connection to specific LAN devices.</p>

<p>For example, a user might have four PCs in the home, have a WAN
connection to the Internet and have a WAN connection to an employer’s
network. The RG could be configured to allow all PCs access to the
Internet, but only one specific PC might be allowed to send traffic over
the WAN interface to the employer’s network.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.15">LAN.FWD.15<a class="headerlink" href="08-index-lan.html#req:lan.fwd.15" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the possibility that all LAN devices concurrently
access one or more WAN connections.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.16">LAN.FWD.16<a class="headerlink" href="08-index-lan.html#req:lan.fwd.16" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support the ability to accept IPv4 routes dynamically
pushed from the WAN. This allows it to set up routing tables to support
routing traffic over multiple connections (PVCs, PPPoE sessions, etc.).
In particular, the RG SHOULD be configurable to accept RIP version 2
(RIP-2) messages as defined in RFC 2453 <span class="cite" data-citation-ids="RFC2453"><a href='03-index-references-and-terminology.html#ref-RFC2453' title=''>[65]</a></span> to fulfill this task.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.17">LAN.FWD.17<a class="headerlink" href="08-index-lan.html#req:lan.fwd.17" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If RIP-2 is supported, it SHOULD be software configurable.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.18">LAN.FWD.18<a class="headerlink" href="08-index-lan.html#req:lan.fwd.18" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If RIP-2 is supported, by default, the RG MUST NOT transmit RIP-2
information to WAN connections.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.19">LAN.FWD.19<a class="headerlink" href="08-index-lan.html#req:lan.fwd.19" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If RIP-2 is supported, the RG MUST be configurable to accept triggered
RIP messages, as defined in RFC 2091 <span class="cite" data-citation-ids="RFC2091"><a href='03-index-references-and-terminology.html#ref-RFC2091' title=''>[58]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fwd.20">LAN.FWD.20<a class="headerlink" href="08-index-lan.html#req:lan.fwd.20" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to bridge IPv4 or route IPv4 or IPv6 over an
Ethernet session concurrently with at least one RG-originated PPPoE
session on each PVC that is running bridged Ethernet over the AAL.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fwd.21">LAN.FWD.21<a class="headerlink" href="08-index-lan.html#req:lan.fwd.21" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD be capable of initiating at least two PPPoE sessions per
PVC and forwarding the IP (v4 or v6) traffic above PPPoE to the LAN CPE.</td>
</tr>
</table>

<h3 id="sec:req:lan.igmp">4.3.13 LAN.IGMP – IGMP<a class="headerlink" href="08-index-lan.html#sec:req:lan.igmp" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<h4 id="sec:req:lan.igmp.bridged">4.3.13.1 LAN.IGMP.BRIDGED – IGMP and Multicast in Bridged Configurations (IPv4)<a class="headerlink" href="08-index-lan.html#sec:req:lan.igmp.bridged" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.bridged.1">LAN.IGMP.BRIDGED.1<a class="headerlink" href="08-index-lan.html#req:lan.igmp.bridged.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If the RG is in a bridge type architecture and an IGMP querier is
supported in the access network, the RG MUST support IGMP snooping per
IP bridge to an individual LAN addressable port or interface level (each
Ethernet port, USB (PC), Wi-Fi, etc.). On each interface, the RG MUST
forward only the multicast groups explicitly requested by that
interface. A recommended reference implementation can be found in IETF
RFC 4541 <span class="cite" data-citation-ids="RFC4541"><a href='03-index-references-and-terminology.html#ref-RFC4541' title=''>[108]</a></span>.</td>
</tr>
</table>

<h4 id="sec:req:lan.igmp.routed">4.3.13.2 LAN.IGMP.ROUTED – IGMP and Multicast in Routed Configurations (IPv4)<a class="headerlink" href="08-index-lan.html#sec:req:lan.igmp.routed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.1">LAN.IGMP.ROUTED.1<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support an IGMP proxy-routing function as defined in RFC 4605
<span class="cite" data-citation-ids="RFC4605"><a href='03-index-references-and-terminology.html#ref-RFC4605' title=''>[109]</a></span>. This satisfies Broadband Forum TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-225.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.2">LAN.IGMP.ROUTED.2<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support IGMPv3 as defined in IETF <span class="cite" data-citation-ids="RFC3376"><a href='03-index-references-and-terminology.html#ref-RFC3376' title=''>[85]</a></span>. This satisfies
TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-226.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.3">LAN.IGMP.ROUTED.3<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support IGMP proxy-routing with local NAT and firewall
features including establishing any pin-holes in the firewall for the
multicast streams received (after join). This satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-227.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.4">LAN.IGMP.ROUTED.4<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the RG is configured with multiple WAN-facing IPv4 interfaces
(e.g. PPP or IPoE), the IGMP proxy-routing function MUST be able to
configure a filter for multicasting upstream IGMP messages to one or
more interfaces. This satisfies <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> requirements R-228 and R-229.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.5">LAN.IGMP.ROUTED.5<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">When the RG receives an IGMP membership query on a given WAN-facing IPv4
interface, the IGMP proxy-routing function MUST only send a
corresponding membership report on this specific interface. This
satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-230.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.6">LAN.IGMP.ROUTED.6<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD be able to classify IGMP requests according to source
IPv4/MAC address or incoming LAN physical port to distinguish between
multicast services (e.g. IPTV and some other best effort Internet
multicast application). This satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-231.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.7">LAN.IGMP.ROUTED.7<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST have a way to suppress the flooding of multicast to all LAN
devices by only sending the traffic to selected ports/interfaces, either
through configuration of dedicated ports connecting to multicast hosts
or IGMP proxy-routing (where the traffic is only sent to host devices
that have joined the multicast group). This satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-232.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.8">LAN.IGMP.ROUTED.8<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">It MUST be possible to configure a WAN-facing IPv4 interface with an
IPoE encapsulation and no IPv4 address visible by the access network. It
MUST be possible to receive multicast traffic on such an interface,
independent of whether upstream IGMP is sent on this interface or not.
The RG’s IGMP proxy-routing function MUST be able to send upstream IGMP
traffic on such an interface, using an unspecified (0.0.0.0/::) IPv4
source address. This satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> requirements R-269, R-270 and
R-271.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.9">LAN.IGMP.ROUTED.9<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">All RG LAN ports and interfaces MUST be capable of processing IGMP
messages.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.10">LAN.IGMP.ROUTED.10<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD be able to allow (default) or discard IGMP join requests
based on the source interface, port and host. This satisfies the
requirement stated in TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-233.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.11">LAN.IGMP.ROUTED.11<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support IGMP snooping per IPv4 bridge to an individual LAN
addressable port or interface level (each Ethernet port, USB (PC),
Wi-Fi, etc.). A recommended reference implementation can be found in
<span class="cite" data-citation-ids="RFC4541"><a href='03-index-references-and-terminology.html#ref-RFC4541' title=''>[108]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.12">LAN.IGMP.ROUTED.12<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be configurable to prevent sending IGMP messages to the WAN
interfaces for specified multicast groups or ranges (such as 239.0.0.0
through 239.255.255.255 for IPv4, which are limited scope or
administratively scoped addresses).</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.13">LAN.IGMP.ROUTED.13<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.13" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST default to not sending IGMP messages for IPv4 addresses
239.0.0.0 through 239.255.255.255 to the WAN interfaces. This satisfies
TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-235.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.igmp.routed.14">LAN.IGMP.ROUTED.14<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.14" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST have a join and leave latency less than 20 ms.</p>

<p>This means that when the RG receives a leave, it must stop sending the
stream to that device (although it is expected to continue sending to
other devices that have not left) in less than 20 ms. The RG must not
wait for the results of a membership query before it stops sending the
stream. Rather, it must rely on its membership database to know whether
there are other devices receiving that stream. When the RG receives a
join, its allocation of the overall time for starting to forward that
stream must not exceed 20 ms.</p>

<p>This latency definition handles southbound join/leave; however a
definition for the northbound join/leave latency will also be useful.
Also, the northbound as well as southbound latency definition involves a
tradeoff between multicast system dynamics (lower latency -&gt; higher
dynamics) and bandwidth efficiency (low latency -&gt; better bandwidth
efficiency). A statistical analysis will be helpful, based on empirical
TV channel switching dynamics, when available.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.15">LAN.IGMP.ROUTED.15<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.15" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support IGMP immediate leave (also known as fast leave) with
explicit host tracking. This satisfies TR-101 <span class="cite" data-citation-ids="TR-101"><a href='03-index-references-and-terminology.html#ref-TR-101' title=''>[161]</a></span> R-234.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.16">LAN.IGMP.ROUTED.16<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.16" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a minimum of 32 multicast groups.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.17">LAN.IGMP.ROUTED.17<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.17" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support a minimum of 64 multicast groups.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.18">LAN.IGMP.ROUTED.18<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.18" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be configurable to log (on demand) all IGMP messages on both
the LAN and WAN interfaces.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.19">LAN.IGMP.ROUTED.19<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.19" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to provide a summary of the current state of IGMP
group memberships as managed by the RG (e.g. multicast groups and LAN
devices currently associated with each multicast group).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.20">LAN.IGMP.ROUTED.20<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.20" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to provide a summary of IGMP activity over specific
time periods (e.g. previous hour, previous day, since reboot, etc.), per
multicast stream and per LAN device.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.21">LAN.IGMP.ROUTED.21<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.21" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to report IGMP statistics and logs through the Web
GUI, TR-064i2 interfaces and to a Controller.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.igmp.routed.22">LAN.IGMP.ROUTED.22<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.22" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be capable of supporting LAN to LAN multicast between
devices on a shared medium, and between devices on separate switched LAN
interfaces.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.igmp.routed.23">LAN.IGMP.ROUTED.23<a class="headerlink" href="08-index-lan.html#req:lan.igmp.routed.23" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be configurable as to how many simultaneous multicast
streams are allowed from WAN to LAN.</td>
</tr>
</table>

<h3 id="sec:req:lan.mld">4.3.14 LAN.MLD – Multicast Listener Discovery (MLD)<a class="headerlink" href="08-index-lan.html#sec:req:lan.mld" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<h4 id="sec:req:lan.mld.routed">4.3.14.1 LAN.MLD.ROUTED – MLD and Multicast in Routed Configurations (IPv6)<a class="headerlink" href="08-index-lan.html#sec:req:lan.mld.routed" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.mld.routed.1">LAN.MLD.ROUTED.1<a class="headerlink" href="08-index-lan.html#req:lan.mld.routed.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support MLDv2 as defined in RFC 3810 <span class="cite" data-citation-ids="RFC3810"><a href='03-index-references-and-terminology.html#ref-RFC3810' title=''>[92]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.mld.routed.2">LAN.MLD.ROUTED.2<a class="headerlink" href="08-index-lan.html#req:lan.mld.routed.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support functionality as described for IGMP in requirements
<a href='08-index-lan.html#sec:req:lan.igmp.routed' title=''>LAN.IGMP.ROUTED</a>. 1, 3-5, 7, 9, 11, 14-16, 18-23</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.mld.routed.3">LAN.MLD.ROUTED.3<a class="headerlink" href="08-index-lan.html#req:lan.mld.routed.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support functionality as described for IGMP in
requirements <a href='08-index-lan.html#sec:req:lan.igmp.routed' title=''>LAN.IGMP.ROUTED</a>. 6, 10, 17</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.mld.routed.4">LAN.MLD.ROUTED.4<a class="headerlink" href="08-index-lan.html#req:lan.mld.routed.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be configurable to prevent sending MLD messages to the WAN
interfaces for specified multicast addresses or scopes.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.mld.routed.5">LAN.MLD.ROUTED.5<a class="headerlink" href="08-index-lan.html#req:lan.mld.routed.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST default to not sending MLD messages for scope of 0 through 8.</td>
</tr>
</table>

<h3 id="sec:req:lan.fw">4.3.15 LAN.FW – Firewall (Basic)<a class="headerlink" href="08-index-lan.html#sec:req:lan.fw" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>This module applies to IPv6 as well as IPv4, but only if the RG has an
IPv6 stack</p>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.1">LAN.FW.1<a class="headerlink" href="08-index-lan.html#req:lan.fw.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST drop or deny IPv4 access requests from WAN side connections
to LAN side devices and to the RG itself except in direct response to
outgoing traffic or as explicitly permitted through configuration of the
RG (e.g. for port forwarding or management).</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.2">LAN.FW.2<a class="headerlink" href="08-index-lan.html#req:lan.fw.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a separate firewall log to maintain records of
transactions according to firewall rules.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.3">LAN.FW.3<a class="headerlink" href="08-index-lan.html#req:lan.fw.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The firewall log file MUST be able to hold at least the last 100 entries
or 10 Kbytes of text.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.4">LAN.FW.4<a class="headerlink" href="08-index-lan.html#req:lan.fw.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Firewall log entries SHOULD NOT be cleared except when the RG is reset
to its factory default settings.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.5">LAN.FW.5<a class="headerlink" href="08-index-lan.html#req:lan.fw.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST timestamp each firewall log entry.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.6">LAN.FW.6<a class="headerlink" href="08-index-lan.html#req:lan.fw.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the definition of IPv6 firewall rules separate from
IPv4.</td>
</tr>
</table>

<h4 id="sec:req:lan.fw.spi">4.3.15.1 LAN.FW.SPI – Firewall (Advanced)<a class="headerlink" href="08-index-lan.html#sec:req:lan.fw.spi" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<p>This module applies to IPv6 as well as IPv4, but only if the RG has an
IPv6 stack.</p>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.1">LAN.FW.SPI.1<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a more robust firewall, such as one that provides a
full OSI 7 layer stack stateful packet inspection and packet filtering
function.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.fw.spi.2">LAN.FW.SPI.2<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD provide protection for the following:</p>

<ul>
<li><p>Port scans</p></li>
<li><p>Packets with same source and destination addresses</p></li>
<li><p>Packets with a broadcast source address</p></li>
<li><p>Downstream packets with a LAN source address</p></li>
<li><p>Invalid fragmented IP (v4 or v6) packets</p></li>
<li><p>Fragmented TCP packets</p></li>
<li><p>Packets with invalid TCP flag settings (NULL, FIN, Xmas, etc.)</p></li>
<li><p>Fragmented packet headers (TCP, UDP and ICMP)</p></li>
<li><p>Inconsistent packet header lengths</p></li>
<li><p>Packet flooding</p></li>
<li><p>Excessive number of sessions</p></li>
<li><p>Invalid ICMP requests</p></li>
<li><p>Irregular sequence differences between TCP packets</p></li>
</ul>

<p>The extent of this protection will be limited when the RG is configured
as a bridge in which only PPPoE traffic is bridged. This protection MUST
be available when the RG terminates IP (v4 or v6) or bridges IPv4.</p></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.3">LAN.FW.SPI.3<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Each type of attack for which protection is provided SHOULD be
configurable on the RG and be on by default.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.spi.4">LAN.FW.SPI.4<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support passing and blocking of traffic by user-defined and
TR-181 configurable rules.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.5">LAN.FW.SPI.5<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support setting firewall rules by an Controller that cannot
be altered by the user. If firewall rules are set via security policies
in TR-181i2 profiles, or via other mechanisms such as Controller file
download, the rules MUST NOT be able to be overridden by user firewall
rules.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.spi.6">LAN.FW.SPI.6<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the user temporarily disabling specific user-defined
rules or all user defined rules, that is, without deleting the rules.</td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.fw.spi.7">LAN.FW.SPI.7<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support the user specifying the order in which firewall
rules are processed.</p>

<p>Note: not all firewall rules need be included under the scope of this
requirement.</p></td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.fw.spi.8">LAN.FW.SPI.8<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD support specification of any of the following in a
firewall rule:</p>

<ul>
<li><p>destination IP (v4 or v6) address(es) with subnet mask</p></li>
<li><p>originating IP (v4 or v6) address(es) with subnet mask</p></li>
<li><p>source MAC address</p></li>
<li><p>destination MAC address</p></li>
<li><p>protocol (0-255, or by alias: TCP, UDP, ICMP, IP, IGMP, eigrp, gre,
ipinip, pim, nos, ospf, …)</p></li>
<li><p>source port</p></li>
<li><p>destination port</p></li>
<li><p>IEEE 802.1Q user priority</p></li>
<li><p>FQDN (fully qualified domain name) of WAN session</p></li>
<li><p>DiffServ codepoint (<span class="cite" data-citation-ids="RFC3260"><a href='03-index-references-and-terminology.html#ref-RFC3260' title=''>[82]</a></span>)</p></li>
<li><p>Ethertype (IEEE 802.3) length/type field)</p></li>
<li><p>Traffic matching an ALG filter</p></li>
<li><p>IEEE 802.1Q VLAN identification</p></li>
<li><p>packet length</p></li>
<li><p>TCP flags (urg, ack, psh, rst, syn, fin)</p></li>
<li><p>IP option values (potentially name aliases)</p></li>
<li><p>logical interface of source</p></li>
<li><p>logical interface of destination</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.9">LAN.FW.SPI.9<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY support filtering based on other fields unique to specific
protocols.</td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.fw.spi.10">LAN.FW.SPI.10<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD support firewall rules that support generic pattern
matching against the header or data payload of traffic. Logically this
can be envisioned as:</p>

<ul>
<li><p>match(header[offset[,length|max]], condition)</p></li>
<li><p>match(payload[offset[,length|max]], condition)</p></li>
</ul>

<p>where condition is (relationship, data) such as:</p>

<ul>
<li><p>(=, ne, all, one, and, or) for a hex field</p></li>
<li><p>(=, ne, gt, ge, lt, le) for a decimal/hex field</p></li>
<li><p>(=, ne, contains) for a string field</p></li>
</ul></td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.11">LAN.FW.SPI.11<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support a set of predefined rules to which the user can
set or reset the firewall settings.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.spi.12">LAN.FW.SPI.12<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">If a set of predefined rules has been set on the RG, the RG rule set
SHOULD be able to be used as the basis for a user maintained set of
firewall rules.</td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.fw.spi.13">LAN.FW.SPI.13<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.13" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>In addition to blocking or passing traffic identified by a firewall
filter, the RG MUST support other actions as well, including but not
limited to:</p>

<ul>
<li><p>logging on success or failure,</p></li>
<li><p>notification on success or failure (to email or pager if supported),</p></li>
<li><p>sending notification to a PC monitor application (either originator
and or centralized source), and</p></li>
<li><p>requesting verification from a PC monitor application.</p></li>
</ul></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.spi.14">LAN.FW.SPI.14<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.14" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST allow for configuration of global firewall values.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.fw.spi.15">LAN.FW.SPI.15<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.15" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG firewall SHOULD be either ICSA certified
(<a href='http://www.icsalabs.com/' title=''><em>www.icsalabs.com</em></a>) or be able to display
all the attributes necessary for ICSA certification for the current
version of either the Residential category or the Small/Medium Business
(SMB) category.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.fw.spi.16">LAN.FW.SPI.16<a class="headerlink" href="08-index-lan.html#req:lan.fw.spi.16" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Unless configured otherwise, DOS, port blocking and stateful packet
inspection MUST be provided to all LAN devices receiving traffic from
the WAN interface.</td>
</tr>
</table>

<h3 id="sec:req:lan.filter">4.3.16 LAN.FILTER – Filtering<a class="headerlink" href="08-index-lan.html#sec:req:lan.filter" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<h4 id="sec:req:lan.filter.time">4.3.16.1 LAN.FILTER.TIME – Time of Day Filtering<a class="headerlink" href="08-index-lan.html#sec:req:lan.filter.time" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.filter.time.1">LAN.FILTER.TIME.1<a class="headerlink" href="08-index-lan.html#req:lan.filter.time.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY support filtering based on time of day on a per LAN device
basis.</td>
</tr>
</table>

<h4 id="sec:req:lan.filter.content">4.3.16.2 LAN.FILTER.CONTENT – Content Filtering<a class="headerlink" href="08-index-lan.html#sec:req:lan.filter.content" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.filter.content.1">LAN.FILTER.CONTENT.1<a class="headerlink" href="08-index-lan.html#req:lan.filter.content.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MAY support filtering based on web content or URL string
screening techniques on a per LAN device basis.</td>
</tr>
</table>

<h3 id="sec:req:lan.diagnostics">4.3.17 LAN.DIAGNOSTICS – Automated User Diagnostics<a class="headerlink" href="08-index-lan.html#sec:req:lan.diagnostics" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.diagnostics.1">LAN.DIAGNOSTICS.1<a class="headerlink" href="08-index-lan.html#req:lan.diagnostics.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>If the RG is on the same subnet as any LAN device, when network
connectivity problems occur, the RG MUST provide a mechanism that
intercepts web browser pages (i.e. port 80 web page requests) and
responds to these by directing the web browser to appropriate internal
web pages to identify and resolve network connectivity problems
including but not limited to:</p>

<ul>
<li><p>DSL cannot train</p></li>
<li><p>DSL signal not detected</p></li>
<li><p>Broadband Ethernet not connected (if applicable)</p></li>
<li><p>ATM PVC not detected (if applicable)</p></li>
<li><p>IEEE 802.1x failure (if applicable)</p></li>
<li><p>PPP server not detected (if applicable)</p></li>
<li><p>PPP authentication failed (if applicable)</p></li>
<li><p>DHCP not available</p></li>
</ul></td>
</tr>
</table>

<h3 id="sec:req:lan.captive">4.3.18 LAN.CAPTIVE – Captive Portal with Web Redirection<a class="headerlink" href="08-index-lan.html#sec:req:lan.captive" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<p>This module applies to IPv6 as well as IPv4, but only if the RG has an
IPv6 stack.</p>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.captive.1">LAN.CAPTIVE.1<a class="headerlink" href="08-index-lan.html#req:lan.captive.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support a redirect function, which, when enabled, intercepts
WAN destination IP (v4 or v6) HTTP requests and responds to these by
substituting a specified URL in place of the web page request.</p>

<p>The URL, as well as a list of locations for which this redirect would be
bypassed (i.e. white list), MUST be settable from a Controller.</p>

<p>The actual captive portal to be redirected to may be established at the
time the white list is defined or the white list may be defined first
and the captive portal specified at a later time.</p></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.captive.2">LAN.CAPTIVE.2<a class="headerlink" href="08-index-lan.html#req:lan.captive.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The redirection function and associated fields MUST NOT be modifiable by
the subscriber.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.captive.3">LAN.CAPTIVE.3<a class="headerlink" href="08-index-lan.html#req:lan.captive.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support turning on and off the redirect function when the
captive portal URL field is populated and cleared respectively by the
Controller.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.captive.4">LAN.CAPTIVE.4<a class="headerlink" href="08-index-lan.html#req:lan.captive.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">All port 80 traffic, excluding that associated with the white list, MUST
be redirected when the redirect function is turned on in the RG.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.captive.5">LAN.CAPTIVE.5<a class="headerlink" href="08-index-lan.html#req:lan.captive.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">To specify the captive portal, the RG must accept an IPv4 or IPv6
address or a URL whose length does not exceed 2000 characters.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.captive.6">LAN.CAPTIVE.6<a class="headerlink" href="08-index-lan.html#req:lan.captive.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The redirect white list MUST support 512 separate list entries, each of
which can be an individual IP (v4 or v6) address, a range of IPv4
addresses, an IPv6 prefix, or any combination thereof. For a range of
IPv4 addresses a subnet mask is required.</td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.captive.7">LAN.CAPTIVE.7<a class="headerlink" href="08-index-lan.html#req:lan.captive.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>Variable length subnet masking (VLSM) MUST be supported in the redirect
white list. For example:</p>

<ul>
<li><p>Individual IPv4 address:</p>

<ul>
<li><p>ipaddress or</p></li>
<li><p>ipaddress/32 or</p></li>
<li><p>ipaddress 255.255.255.255</p></li>
</ul></li>
<li><p>Range of 64 IPv4 addresses:</p>

<ul>
<li><p>ipaddress/26 or</p></li>
<li><p>ipaddress 255.255.192.0</p></li>
</ul></li>
</ul></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.captive.8">LAN.CAPTIVE.8<a class="headerlink" href="08-index-lan.html#req:lan.captive.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support only one set of captive portal and redirect settings
at a time. If new settings are needed, the Controller will overwrite
existing values within the RG.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.captive.9">LAN.CAPTIVE.9<a class="headerlink" href="08-index-lan.html#req:lan.captive.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">A valid set of redirect settings MUST be enabled in an RG within five
seconds of the redirect URL being sent from the Controller.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.captive.10">LAN.CAPTIVE.10<a class="headerlink" href="08-index-lan.html#req:lan.captive.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The redirect function MUST be disabled on the RG within five seconds of
the captive portal string being cleared in a RG by an empty redirect URL
being sent from the Controller.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.captive.11">LAN.CAPTIVE.11<a class="headerlink" href="08-index-lan.html#req:lan.captive.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Incremental packet delay through the RG due to white list lookup MUST
NOT exceed 5 ms.</td>
</tr>
</table>

<h3 id="sec:req:lan.qos">4.3.19 LAN.QoS – LAN quality of service requirements<a class="headerlink" href="08-index-lan.html#sec:req:lan.qos" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.qos.1">LAN.QoS.1<a class="headerlink" href="08-index-lan.html#req:lan.qos.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support classification of LAN directed WAN traffic and
placement into appropriate queues (or discard) based on any one or more
of the following pieces of information:</p>

<ol>
<li><p>destination IP address(es) with subnet mask,</p></li>
<li><p>originating IP address(es) with subnet mask,</p></li>
<li><p>Diffserv codepoint (<span class="cite" data-citation-ids="RFC3260"><a href='03-index-references-and-terminology.html#ref-RFC3260' title=''>[82]</a></span>),</p></li>
<li><p>protocol (TCP, UDP, ICMP, IGMP …),</p></li>
<li><p>source TCP/UDP port and port range,</p></li>
<li><p>destination TCP/UDP port and port range</p></li>
</ol>

<p>In an ATM based access network:</p>

<ol>
<li>ATM VPI/VCI</li>
</ol>

<p>Where Ethernet is present on the access link:</p>

<ol>
<li><p>source MAC address,</p></li>
<li><p>destination MAC address,</p></li>
<li><p>IEEE 802.1Q Ethernet priority,</p></li>
<li><p>Ethertype (IEEE 802.3) length/type field), and</p></li>
<li><p>IEEE 802.1Q VLAN identification.</p></li>
</ol></td>
</tr>
<tr class="even">
<td align="left"><p><span id="req:lan.qos.2">LAN.QoS.2<a class="headerlink" href="08-index-lan.html#req:lan.qos.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD support classification of LAN directed WAN traffic and
placement into appropriate queues (or discard) based on any one or more
of the following pieces of information:</p>

<ol>
<li>packet length (note: to be used judiciously to avoid out of order
packet delivery).</li>
</ol></td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.qos.3">LAN.QoS.3<a class="headerlink" href="08-index-lan.html#req:lan.qos.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG MUST support classification of LAN directed traffic and placement
into appropriate queues (or discard) based on any one or more of the
following pieces of information:</p>

<ol>
<li><p>source MAC address, and</p></li>
<li><p>destination MAC address.</p></li>
</ol></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.qos.4">LAN.QoS.4<a class="headerlink" href="08-index-lan.html#req:lan.qos.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD support classification of LAN directed traffic and
placement into appropriate queues (or discard) based on any one or more
of the pieces of information defined in <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>. 1, <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>. 2, <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>.
22 and <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>. 23.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.qos.5">LAN.QoS.5<a class="headerlink" href="08-index-lan.html#req:lan.qos.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support classification of LAN directed internally generated
traffic and placement into appropriate queues based on any one or more
of information defined in <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>. 20 and <a href='07-index-wan.html#sec:req:wan.qos' title=''>WAN.QoS</a>. 21.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.qos.6">LAN.QoS.6<a class="headerlink" href="08-index-lan.html#req:lan.qos.6" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to mark or remark the Diffserv codepoint of traffic
identified based on any of the classifiers supported by the RG.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.qos.7">LAN.QoS.7<a class="headerlink" href="08-index-lan.html#req:lan.qos.7" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support a minimum of four downstream queues per LAN port.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.qos.8">LAN.QoS.8<a class="headerlink" href="08-index-lan.html#req:lan.qos.8" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST duplicate the set of queues for each LAN egress port. This
can be done logically or physically.</td>
</tr>
<tr class="odd">
<td align="left"><p><span id="req:lan.qos.9">LAN.QoS.9<a class="headerlink" href="08-index-lan.html#req:lan.qos.9" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></p></td>
<td align="left"><p>The RG SHOULD be able to configure each queue for strict priority or
weighted round robin scheduling.</p>

<p>Strict priority queues are served with priority over all other queues.
WRR queues are served on the basis of configurable weights.</p></td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.qos.10">LAN.QoS.10<a class="headerlink" href="08-index-lan.html#req:lan.qos.10" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST provide counters in terms of dropped and emitted
packets/bytes for each queue. Statistics SHOULD be collected from the
time of last counter reset or on a configurable sample interval.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.qos.11">LAN.QoS.11<a class="headerlink" href="08-index-lan.html#req:lan.qos.11" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST provide information about queue occupancy in terms of
packets and peak percentage. Statistics SHOULD be collected from the
time of last counter reset or on a configurable sample interval.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.qos.12">LAN.QoS.12<a class="headerlink" href="08-index-lan.html#req:lan.qos.12" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG SHOULD be able to monitor the physical layer rate of the LAN
interfaces, maintaining information about the current available
bandwidth and measurement history.</td>
</tr>
</table>

<h3 id="sec:req:lan.sipserver">4.3.20 LAN.SIPserver – SIP Server<a class="headerlink" href="08-index-lan.html#sec:req:lan.sipserver" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.sipserver.1">LAN.SIPserver.1<a class="headerlink" href="08-index-lan.html#req:lan.sipserver.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the SIP registrar server function (<span class="cite" data-citation-ids="RFC3261"><a href='03-index-references-and-terminology.html#ref-RFC3261' title=''>[83]</a></span>),
accept <em>register</em> requests and
respond to them with <em>success</em> or <em>failure</em> indication.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.sipserver.2">LAN.SIPserver.2<a class="headerlink" href="08-index-lan.html#req:lan.sipserver.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the SIP registrar server function (<span class="cite" data-citation-ids="RFC3261"><a href='03-index-references-and-terminology.html#ref-RFC3261' title=''>[83]</a></span>), and
place the information it
receives in <em>register</em> requests into the location service for the domain
it handles.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.sipserver.3">LAN.SIPserver.3<a class="headerlink" href="08-index-lan.html#req:lan.sipserver.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the SIP redirect server function (<span class="cite" data-citation-ids="RFC3261"><a href='03-index-references-and-terminology.html#ref-RFC3261' title=''>[83]</a></span>), receive
SIP requests and respond
with 3xx (redirection) responses, directing the SIP client to contact an
alternate set of SIP addresses.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.sipserver.4">LAN.SIPserver.4<a class="headerlink" href="08-index-lan.html#req:lan.sipserver.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the SIP proxy server function (<span class="cite" data-citation-ids="RFC3261"><a href='03-index-references-and-terminology.html#ref-RFC3261' title=''>[83]</a></span>), acting as a
proxy for the SIP
client to route SIP requests in the direction of the corresponding proxy
server, and acting in place of a server to route SIP responses toward
the SIP client.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.sipserver.5">LAN.SIPserver.5<a class="headerlink" href="08-index-lan.html#req:lan.sipserver.5" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">Acting as proxy, the RG MUST consistently operate in either a stateful
or stateless mode for each new SIP request.</td>
</tr>
</table>

<h3 id="sec:req:lan.sipmixer">4.3.21 LAN.SIPmixer – SIP Mixer<a class="headerlink" href="08-index-lan.html#sec:req:lan.sipmixer" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.sipmixer.1">LAN.SIPmixer.1<a class="headerlink" href="08-index-lan.html#req:lan.sipmixer.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support the SIP mixer function (<span class="cite" data-citation-ids="RFC3550"><a href='03-index-references-and-terminology.html#ref-RFC3550' title=''>[87]</a></span>) to mix incoming
multiple streams to adapt to the participant’s network condition.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.sipmixer.2">LAN.SIPmixer.2<a class="headerlink" href="08-index-lan.html#req:lan.sipmixer.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST have the capability to change the encoding format of
incoming multiple streams.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.sipmixer.3">LAN.SIPmixer.3<a class="headerlink" href="08-index-lan.html#req:lan.sipmixer.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST terminate any RTCP messages sent to (or received from)
clients, but generate its own RTCP messages and send them to (or send
them out on behalf of) clients.</td>
</tr>
</table>

<h3 id="sec:req:lan.interworking">4.3.22 LAN.Interworking – 3GPP Interworking<a class="headerlink" href="08-index-lan.html#sec:req:lan.interworking" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h3>

<h4 id="sec:req:lan.interworking.ue-authentication">4.3.22.1 LAN.Interworking.UE-Authentication – 3GPP User Equipment Authentication Support<a class="headerlink" href="08-index-lan.html#sec:req:lan.interworking.ue-authentication" title="Permalink to this header"> <img src='permalink.png' title='' width="0.8em"/></a></h4>

<table>
<col width="20%" />
<col width="80%" />
<tr class="header">
<th align="left">ID</th>
<th align="left">Requirement</th>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.interworking.ue-authentication.1">LAN.Interworking.UE-Authentication.1<a class="headerlink" href="08-index-lan.html#req:lan.interworking.ue-authentication.1" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to act as an 802.1X authenticator using a RADIUS
client (as defined in RFC 3579 <span class="cite" data-citation-ids="RFC3579"><a href='03-index-references-and-terminology.html#ref-RFC3579' title=''>[88]</a></span>).
connected to a fixed access AAA server.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.interworking.ue-authentication.2">LAN.Interworking.UE-Authentication.2<a class="headerlink" href="08-index-lan.html#req:lan.interworking.ue-authentication.2" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST support proxying EAP-AKA/EAP-AKA’ messages over RADIUS,
using an internal RADIUS client.</td>
</tr>
<tr class="odd">
<td align="left"><span id="req:lan.interworking.ue-authentication.3">LAN.Interworking.UE-Authentication.3<a class="headerlink" href="08-index-lan.html#req:lan.interworking.ue-authentication.3" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to receive policies from the AAA server during User
Equipment authentication and during an ongoing session using RADIUS CoA
as per RFC 5176 <span class="cite" data-citation-ids="RFC5176"><a href='03-index-references-and-terminology.html#ref-RFC5176' title=''>[118]</a></span>.</td>
</tr>
<tr class="even">
<td align="left"><span id="req:lan.interworking.ue-authentication.4">LAN.Interworking.UE-Authentication.4<a class="headerlink" href="08-index-lan.html#req:lan.interworking.ue-authentication.4" title="Permalink to this span"> <img src='permalink.png' title='' width="0.8em"/></a></span></td>
<td align="left">The RG MUST be able to have pre-configured policies to handle User
Equipment traffic or to download such policies via RADIUS from the AAA
server during authentication or by using RADIUS CoA.</td>
</tr>
</table>

